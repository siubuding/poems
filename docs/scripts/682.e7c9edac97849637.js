"use strict";(self.webpackChunkpoemsng=self.webpackChunkpoemsng||[]).push([[682],{2682:(ce,b,o)=>{o.r(b),o.d(b,{ReaderViewModule:()=>se});var s=o(6895),Y=o(9814),c=o(4006),Q=o(7077),_=o(9299),w=o(6818),e=o(4650),m=o(7888),d=o(5545),F=o(5599),x=o(4859),Z=o(3238),v=o(7392),f=o(6338),p=o(3267),A=o(3683),g=o(1576),R=o(6849),N=o(9291),J=o(1983);function O(n,i){if(1&n&&(e.TgZ(0,"mat-list-option",13,14)(2,"div",15),e._uU(3),e.TgZ(4,"p",16),e._uU(5),e.ALo(6,"date"),e.qZA()()()),2&n){const t=i.$implicit;e.Q6J("value",t),e.xp6(3),e.hij(" ",t.title," "),e.xp6(2),e.hij(" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",e.xi3(6,3,t.published,"shortDate")," ")}}function B(n,i){if(1&n&&e._UZ(0,"album-meta-viewer",17),2&n){const t=e.oxw();e.Q6J("data",t.currentAlbum)("showTitle",!0)}}function I(n,i){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"poem-viewer",18)(2,"p"),e.qZA()),2&n){const t=i.$implicit,a=e.oxw();e.xp6(1),e.Q6J("data",t)("settings",a.albumPoemViewerSettings)}}let V=(()=>{class n extends w.k{constructor(t,a,l,r,u,T){super(t,a,l,r,u),this.alertService=t,this.albumsService=a,this.poemsService=l,this.basicDataLoaderService=r,this.waitService=u,this.ref=T}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.c9),e.Y36(d.T.Albums),e.Y36(d.T.Poems),e.Y36(F.k),e.Y36(m.ii),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["albums-for-reader"]],features:[e.qOj],decls:19,vars:5,consts:[[1,"fixed-top"],["fxLayoutGap","1em"],["toolbar",""],[1,"toolbar-spacer"],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click"],["hasBackdrop","false"],["mode","over","opened","","fxFlex","50","fixedInViewport","true","position","end","autoFocus","false",3,"fixedTopGap"],["sidenav",""],[3,"multiple","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","auto","fixedInViewport","true"],[3,"data","showTitle",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],["ca","matListOption"],["mat-line",""],[1,"published"],[3,"data","showTitle"],[3,"data","settings"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1,2),e._UZ(3,"main-buttons")(4,"span",3),e.TgZ(5,"button",4),e.NdJ("click",function(){return a.toggleSidenav()}),e.TgZ(6,"mat-icon"),e._uU(7,"reorder"),e.qZA()()()(),e.TgZ(8,"mat-sidenav-container",5)(9,"mat-sidenav",6,7)(11,"mat-selection-list",8),e.NdJ("selectionChange",function(r){return a.handleAlbumChange(r)}),e.YNc(12,O,7,6,"mat-list-option",9),e.qZA()(),e.TgZ(13,"mat-sidenav-content",10),e.YNc(14,B,1,2,"album-meta-viewer",11),e._UZ(15,"p"),e.YNc(16,I,3,2,"div",12),e._UZ(17,"p"),e.qZA()(),e._UZ(18,"p")),2&t&&(e.xp6(9),e.Q6J("fixedTopGap",a.mainToolbarHeight),e.xp6(2),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",a.albums),e.xp6(2),e.Q6J("ngIf",a.currentAlbum.id),e.xp6(2),e.Q6J("ngForOf",a.poemsOfAlbum))},dependencies:[s.sg,s.O5,x.lW,Z.X2,v.Hw,f.Ub,f.vS,p.JX,p.TM,p.Rh,A.Ye,g.SQ,g.yH,R.X,N.E,J.d,s.uU],encapsulation:2}),n})();var G=o(9019),j=o(5529),H=o(6900),P=o(4308),K=o(8353),y=o(3872),L=o(7516),X=o(6709),M=o(7331),h=o(7084),C=o(9549),E=o(284),D=o(5829);function $(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",24,25),e.NdJ("click",function(){e.CHM(t);const l=e.MAs(1),r=e.oxw(4);return e.KtG(r.handleTagClick(l))}),e._uU(2),e.qZA()}if(2&n){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(2),e.hij(" ",t.name," ")}}function k(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-list",21,22),e.NdJ("change",function(l){e.CHM(t);const r=e.oxw(3);return e.KtG(r.handleTagsChange(l))}),e.YNc(2,$,3,2,"mat-chip",23),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t.tags)}}function z(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",24,25),e.NdJ("click",function(){e.CHM(t);const l=e.MAs(1),r=e.oxw(4);return e.KtG(r.handleTagClick(l))}),e._uU(2),e.qZA()}if(2&n){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(2),e.hij(" ",t.name," ")}}function W(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-list",26,22),e.NdJ("change",function(l){e.CHM(t);const r=e.oxw(3);return e.KtG(r.handleTagsChange(l))}),e.YNc(2,z,3,2,"mat-chip",23),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t.tags)}}function q(n,i){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," Tags "),e.qZA(),e.TgZ(4,"mat-panel-description"),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"mat-checkbox",17),e._uU(8,"Filtered by multiple tags"),e.qZA()(),e.TgZ(9,"div",18),e.YNc(10,k,3,1,"mat-chip-list",19),e.YNc(11,W,3,1,"mat-chip-list",20),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.hij(" ",t.tagNames," "),e.xp6(2),e.Q6J("formControl",t.multipleTagsControl),e.xp6(3),e.Q6J("ngIf",t.multipleTagsControl.value),e.xp6(1),e.Q6J("ngIf",!t.multipleTagsControl.value)}}function ee(n,i){if(1&n&&(e.TgZ(0,"mat-list-option",27,28)(2,"div",29),e._uU(3),e.TgZ(4,"p",30),e._uU(5),e.ALo(6,"date"),e.qZA()()()),2&n){const t=i.$implicit;let a;e.Q6J("value",t.id),e.xp6(3),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngClass",t.published?"published":"draft"),e.xp6(1),e.hij(" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",e.xi3(6,4,null!==(a=t.published)&&void 0!==a?a:t.date,"shortDate")," ")}}function te(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-sidenav-container",1)(1,"mat-sidenav",2,3),e.YNc(3,q,12,4,"mat-expansion-panel",4),e.TgZ(4,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(t);const l=e.MAs(5),r=e.oxw();return e.KtG(l.form.valid&&r.search())}),e.TgZ(6,"mat-form-field",7)(7,"mat-label"),e._uU(8,"Search by Keywords"),e.qZA(),e._UZ(9,"input",8),e.TgZ(10,"button",9)(11,"mat-icon"),e._uU(12,"search"),e.qZA()(),e.TgZ(13,"button",10),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.clearKeywords())}),e.TgZ(14,"mat-icon"),e._uU(15,"close"),e.qZA()()()(),e.TgZ(16,"label",11),e._uU(17),e.qZA(),e.TgZ(18,"mat-selection-list",12,13),e.NdJ("selectionChange",function(l){e.CHM(t);const r=e.oxw();return e.KtG(r.handlePoemListChange(l))}),e.YNc(20,ee,7,7,"mat-list-option",14),e.qZA()(),e.TgZ(21,"mat-sidenav-content",15),e._UZ(22,"poem-viewer",16)(23,"p"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("fixedTopGap",t.fixedTopGap),e.xp6(2),e.Q6J("ngIf",t.tags.length>0),e.xp6(6),e.Q6J("formControl",t.keywordsControl),e.xp6(1),e.Q6J("disabled",!t.keywordsControl.value),e.xp6(3),e.Q6J("disabled",!t.keywordsControl.value),e.xp6(4),e.Oqu(t.filteredPoemBriefs.length),e.xp6(1),e.Q6J("multiple",!1),e.xp6(2),e.Q6J("ngForOf",t.filteredPoemBriefs),e.xp6(2),e.Q6J("data",t.currentPoem)("settings",t.poemViewerSettings)}}let ne=(()=>{class n extends K.G{constructor(t,a,l,r,u,T,U){super(t,a,l,u,U),this.poemsService=t,this.alsertService=a,this.dataComponentDialogService=l,this.poemDeletedSubjectService=r,this.alertService=u,this.poemAssociationsChangedSubjectService=T,this.allMetaService=U}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.T.Poems),e.Y36(m.c9),e.Y36(m.T4),e.Y36(y.VE),e.Y36(m.c9),e.Y36(y.ks),e.Y36(L.j))},n.\u0275cmp=e.Xpm({type:n,selectors:[["chronicle-for-reader"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"ngIf"],["hasBackdrop","false","scrollable",""],["mode","over","opened","","fxFlex","50","fixedInViewport","true","position","end","autoFocus","false",3,"fixedTopGap"],["sidenav",""],[4,"ngIf"],["name","searchForm",3,"ngSubmit"],["f","ngForm"],["fxFlex","70"],["matInput","","placeholder","One or multiple keywords separated by space",3,"formControl"],["mat-button","","mat-icon-button","","matSuffix","","type","submit",3,"disabled"],["mat-button","","mat-icon-button","","matSuffix","",3,"disabled","click"],[1,"float-right"],[3,"multiple","selectionChange"],["poemsSelectionList",""],[3,"value",4,"ngFor","ngForOf"],["fxFlex","auto","fixedInViewport","true"],[3,"data","settings"],[3,"formControl"],[1,"scroll-tags"],["selectable","","multiple","true",3,"change",4,"ngIf"],["selectable","","multiple","false",3,"change",4,"ngIf"],["selectable","","multiple","true",3,"change"],["tagChipList",""],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["c","matChip"],["selectable","","multiple","false",3,"change"],[3,"value"],["ca","matListOption"],["mat-line",""],[3,"ngClass"]],template:function(t,a){1&t&&e.YNc(0,te,24,10,"ng-template",0),2&t&&e.Q6J("ngIf",!a.groupedByYearMonth)},dependencies:[s.mk,s.sg,s.O5,c._Y,c.Fj,c.JJ,c.JL,c.F,c.oH,x.lW,X.oG,M.qn,M.HS,h.ib,h.yz,h.yK,h.u4,Z.X2,v.Hw,C.KE,C.hX,C.R9,E.Nt,f.Ub,f.vS,p.JX,p.TM,p.Rh,g.yH,D.oO,R.X,s.uU],encapsulation:2}),n})();function oe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.reload())}),e.TgZ(1,"mat-icon"),e._uU(2,"refresh"),e.qZA()()}}let S=(()=>{class n extends H.A{constructor(t,a,l,r){super(t,l),this.alertService=t,this.poemsService=a,this.basicDataLoaderService=l,this.viewSettingsDialogService=r,console.debug("MainForReaderComponent created")}ngOnInit(){console.debug("MainForReaderComponent init.")}loadBriefs(){G.y.staticReadonly?this.basicDataLoaderService.allMetaService.getBriefsOfPoems().subscribe(t=>{this.poemBriefs=t,this.chronicle?(this.chronicle.filteredPoemBriefs=t.slice(),console.debug("this.chronicle.filteredPoemBriefs assigned.")):console.debug("chronicle not yet available.")}):this.poemsService.getBriefsOfPoems(j.f.convertZhHandler).subscribe({next:t=>{t&&(this.poemBriefs=t,this.chronicle&&(this.chronicle.filteredPoemBriefs=t.slice()))},error:t=>this.alertService.error(t)})}showViewSettings(){this.viewSettingsDialogService.open()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.c9),e.Y36(d.T.Poems),e.Y36(F.k),e.Y36(P.M))},n.\u0275cmp=e.Xpm({type:n,selectors:[["main-for-reader"]],features:[e.qOj],decls:15,vars:2,consts:[[1,"fixed-top"],["fxLayoutGap","1em"],["toolbar",""],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["type","button","mat-button","","mat-raised-button","","mat-icon-button","",3,"click"],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click"],[3,"poemBriefs"],["chronicle",""]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1,2),e._UZ(3,"main-buttons"),e.YNc(4,oe,3,0,"button",3),e._UZ(5,"span",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return a.showViewSettings()}),e.TgZ(7,"mat-icon"),e._uU(8,"settings"),e.qZA()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return a.toggleSidenav()}),e.TgZ(10,"mat-icon"),e._uU(11,"reorder"),e.qZA()()()(),e.TgZ(12,"div"),e._UZ(13,"chronicle-for-reader",7,8),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",!a.isStaticReadonly),e.xp6(9),e.Q6J("poemBriefs",a.poemBriefs))},dependencies:[s.O5,x.lW,v.Hw,A.Ye,g.SQ,J.d,ne],encapsulation:2}),n})();var ae=o(6467);const ie=[{path:"",component:(()=>{class n extends ae.w{constructor(){super()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["reader-index"]],features:[e.qOj],decls:2,vars:0,consts:[[1,"content-top-padding-relative"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},dependencies:[_.lC],encapsulation:2}),n})(),children:[{path:"",component:S},{path:"chronicle",component:S},{path:"albums",component:V}]}];let le=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[_.Bz.forChild(ie),_.Bz]}),n})();var re=o(4466);let se=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[s.ez,c.u5,c.UX,Q.V,Y.o9,re.m,le]}),n})()}}]);